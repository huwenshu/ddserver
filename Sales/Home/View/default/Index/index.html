<extend name="Public/base"/>

<block name="sidebar"></block>

<block name="style">
    <style>
        body{padding: 0}

        .parkitem{list-style:none;width:490px;padding:5px 0 5px 10px;}

        .gray {background:#ddd;}
    </style>
</block>

<block name="body">
    <!-- 主体 -->
    <div id="indexMain" class="index-main">
        <ul class="mui-table-view">
            <li class="mui-table-view-cell">
               <form action="{:U('index')}" method="get">
                   <input type="search" name="searchpark" placeholder="搜索你的停车场" />

                   <table style="width: 100%;table-layout: fixed">
                       <tr>
                           <td><a class="mui-btn mui-btn-success" href="{:U('parkinfo')}">添加停车场</a></td>
                           <td style="width: 50%"><input type="submit" style="float: right" value="搜索" /></td>
                       </tr>
                   </table>
                </form>
            </li>

        <?php

            foreach ($parks_info as $key => $value) {
                echo "<li name='parkitem' class='mui-table-view-cell' alt='".U('parkinfo')."/parkid/".$value['id']."/' ><a class='mui-navigate-right'>";
                echo "<p>".$value['name'].tags($value)."</p>";
                echo "<p>地址：".$value['address']."</p></a></li>";

            }

            //生成Tags
            function tags($value){

                $temp = " ";
                if(strpos($value['style'], 'ZDZJCR')){
                    $temp.="[自动闸机]";
                }

                switch($value['status'])
                {
                case -2:
                    $temp.=" [在接触]";
                    break;
                case -1:
                    $temp.=" [未接触]";
                    break;
                case 0:
                    $temp.=" [找到决策人]";
                    break;
                case 2:
                    $temp.=" [测试中]";
                    break;
                case 1:
                    $temp.=" [已合作]";
                    break;
                default:
                    $temp.="";
                }

                if($value['lat'] == 0.0 || $value['lng'] == 0.0){
                    $temp.=" <font color='red'>[经纬度缺失]</font>";
                }

                return $temp;

            }
        ?>
        </ul>
       
    </div>
</block>

<block name="script">
<script type="text/javascript">
    $(function(){
        $('.sidebar').remove();
        $('[name=parkitem]').click(function(){
            var url= $(this).attr("alt");
            location.href = url;
        });

        $(".parkitem").hover(function() {$(this).addClass("gray")}, function() {$(this).removeClass("gray")});
    });
</script>
</block>